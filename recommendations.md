# Рекомендации

Ниже мы приводим список общих рекомендаций по работе, универсальных для большинства наших клиентов.
Мы настоятельно рекомендуем придерживаться их для достижения наилучших результатов с Adspect.

:::{note}
Данный список не является исчерпывающим и приведен здесь исключительно в информационных целях.
:::

:::{warning}
Несоблюдение этих рекомендаций может привести к блокировкам и/или существенному снижению уровня защиты трафика. Adspect не несет
ответственности за любые подобные негативные последствия.
:::

## Доменные имена и хостинг

1. **Не используйте** доменные имена в дешевых зонах, таких как `.site`, `.club`, `.world` и т.п., потому что
   они привлекают повышенное внимание проверяющих, а также антивирусных и скоринговых компаний. Фактически
   такие доменные имена находятся "на карандаше" с самого момента их регистрации. Используйте только доменные
   зоны `.org`, `.net` и `.com`, в порядке предпочтительности.

   **Совет:** вы можете проверить статус домена в Facebook при помощи [инструментов разработчика](https://developers.facebook.com/tools/debug/sharing/?q=example.com).

2. **Не используйте** доменные имена, содержащие сомнительные или стоп-слова: "sex", "xxx", "win", "diet",
   "health", "meet", "date" и т.д. Включите воображение, придумывайте доменные имена, которые выглядят и
   звучат как бренды.

3. **Всегда используйте** [Cloudflare](https://www.cloudflare.com/) для сокрытия IP-адресов ваших серверов.
   Многие рекламные сети запоминают IP-адреса доменов в заблокированных аккаунтах, однако они никогда
   не забанят IP-адреса одной из крупнейших CDN-компаний, которая обслуживает 10 % всего Интернета.
   Adspect полностью поддерживает Cloudflare в режиме прокси.

4. **Не используйте** технические домены хостинговых компаний. Они выглядят подозрительно и вместе с тем
   уникально идентифицируют отдельные серверы.

5. **Не используйте** виртуальный хостинг Namecheap. Там включен WAF (web application firewall), блокирующий
   по умолчанию POST-запросы, на которых работает наша система, что приводит к ошибкам 403 Forbidden.
   Если вы пользуетесь хостингом Ukraine.com.ua, то **вам необходимо** отключить ModSecurity.

6. **Не называйте** файлы контент- или белой страницы `index.html`, так как вероятно, что они будут иметь
   приоритет над нашим файлом `index.php` при обработке запросов, в URL которых явно не указано имя файла
   после `/`, из-за чего вместо фильтра Adspect будет открываться сама страница. Всегда используйте разные
   имена файлов для контент- и белой страницы, которые сложно угадать.

7. **Всегда проверяйте**, что ваши белые страницы не содержат битых ссылок, незагружающихся изображений или
   скриптов с ошибками. Проверять можно при помощи инструментов разработчика в браузере во вкладках Консоль
   и Сеть --- потенциальные проблемы будут отображены красным.

8. **Не используйте** веб-ресурсы (изображения, стили, скрипты) со сторонних доменов, если только это не
   широко известные CDN (content delivery network), как у jQuery, Bootstrap, Font Awesome, Google Fonts и т.п.
   Скачивайте подключаемые файлы и размещайте их локально.

9. **Всегда настраивайте** HTTPS для ваших страниц. Cloudflare предоставляет бесплатные сертификаты SSL/TLS
   для доменных имен в режиме проксирования. [Let’s Encrypt](https://letsencrypt.org/) также предоставляет
   инфраструктуру для управления бесплатными сертификатами SSL/TLS.

10. **Рекомендуется** использовать хостинг в непосредственной близости от целевой аудитории, в идеале в той
    же стране. Это особенно важно при работе с форматом popunder.

## Рекомендации по клоакингу

Сервис клоакинга --- всего лишь один из элементов системы. Для успешного клоакинга нужно строго соблюдать
массу других условий, список которых может отличаться в зависимости от источника трафика.

1. **Никогда не используйте** доменные имена, креативы, белые страницы повторно после бана в одной и же рекламной
   сети без изменений. Регистрируйте новые доменные имена для новых аккаунтов, уникализируйте креативы и лендинги.

2. **Всегда используйте** наиболее строгие ручные фильтры по стране, ОС, браузеру и языкам. Установите их
   зеркально таргетингам ваших рекламных кампаний.

3. **Всегда используйте** режим отображения белой страницы без редиректа, если возможно. Это требование
   **является обязательным в Facebook, Google Ads, TikTok, Bing, Gemini** (в числе прочих) при использовании PHP-интеграции!

4. **Всегда проверяйте**, что ваши белые страницы выглядят убедительно и правдоподобно, а содержимое
   соотносится с рекламными кампаниями (креативами, языками, таргетингами). **Никогда не указывайте**
   в качестве белых страниц перенаправление на Google и другие подобные явно нецелевые ресурсы.

5. **Используйте собственные белые страницы** вместо конструкторов сайтов ([Shopify](https://www.shopify.com/),
   [Wix](https://wix.com/), [Tilda](https://tilda.cc/) и др.) при работе с Facebook и Google Ads, т.к.
   эти рекламные платформы в последнее время начали превентивно банить рекламные кампании, ведущие на сайты
   на конструкторах из-за их частого использования для клоакинга.

6. При использовании конструкторов **регулярно проверяйте** доступность ваших сайтов --- нередко такие сервисы
   банят сайты при подозрении на их использование в клоакинг-схемах.

7. **Указывайте ссылки** на правдоподобные terms of use, privacy policy и cookies policy на белых страницах
   при работе с более строгими рекламными сетями, такими как Facebook, Google Ads, Microsoft Advertising и т.п.
   **Европейский закон о Cookie также требует**, чтобы сайты явно запрашивали разрешение на использование cookies.

8. **Добавляйте файлы** `robots.txt` и `sitemap.xml` в корневую директорию вашего домена, особенно при работе
   с рекламой в поисковиках (Google Ads, Microsoft Advertising, Яндекс, Yahoo Native и т.п.)

9. **Не используйте** скопированные лендинги без изменений, всегда уникализируйте их так или иначе.
   Это поможет обойти потенциальные блокировки по сигнатурам страниц.

10. **Не используйте** на белых страницах материалы, защищенные авторским правом, так как они могут быть
    обнаружены и отклонены модерацией.

11. **Не используйте** слишком простые, одностраничные, сломанные (в плане верстки и функциональности), не
    оптимизированные для мобильных устройств или просто низкокачественные белые страницы. Всегда помните,
    что белая страница должна выглядеть как правдоподобный и полезный сайт, с аутентичным контентом.

12. **Не используйте** лендинги от якобы "белых" офферов в качестве белых страниц --- понятие рекламных сетей
    о "белом" контенте может сильно отличаться от вашего. **Никогда не используйте** в качестве белых страниц
    прямые партнерские ссылки.

13. **Не изменяйте** белые страницы в работающих кампаниях. Более строгие рекламные сети могут обнаружить даже
    незначительные изменения вроде добавления тегов `<script>` и запустить процедуру проверки кампании или
    всего рекламного аккаунта.

14. **Используйте по одному потоку** для каждой рекламной кампании. Это правило позволяет нам лучше обнаруживать
    подозрительных посетителей статистическими методами. Это также помогает нам лучше анализировать трафик по
    запросу в случае блокировок, так как трафик разных кампаний не смешивается в одном потоке. **Мы не сможем**
    проверить ваш трафик, если вы смешиваете несколько кампаний в одном потоке!

15. **Всегда** отправляйте кампании на модерацию с соответствующими потоками в **режиме "Модерация"** и со
    включенной настройкой **"Заносить все IP-адреса в черный список в режиме Модерация"**. **Не запускайте**
    кампании в режиме "Фильтр"!

16. **Всегда** скачивайте новые PHP-файлы (`index.php`, `filter.php` или `ajax.php`, в зависимости от выбранного
    типа интеграции) после банов --- при каждом скачивании файла генерируется новый уникальный код для сбора
    JavaScript-отпечатков, что позволяет избежать проблем с "запоминанием" предыдущего кода как вредоносного.

17. **Всегда** добавляйте к ссылке все доступные макросы (`__CAMPAIGN_NAME__` и т.п.) кампаниях TikTok Ads.

## Не выделяйтесь!

Большинство рекламных сетей практикует рутинную перепроверку всех рекламных кампаний время от времени.
Помимо помощи в прохождении первичной модерации при запуске новой кампании, первостепенная задача любого
клоакинг-сервиса заключается в защите уже работающих кампаний от этих повторяющихся фоновых проверок.
Adspect справляется с этой задачей очень хорошо, что доказано многими успешными кампаниями в различных
рекламных сетях.

Но есть одно "но": если ваша рекламная активность выделяется на фоне других рекламодателей в глазах
конкретной сети, то это рано или поздно привлечет внимание их модераторов, они начнут изучать ваши
кампании "с пристрастием", неизбежно "пробьют клоаку" и применят к вам административные санкции.
Мы можем гарантировать прочную защиту от рутинных проверок, но ни один сервис не защитит вас от
специально проводимого расследования по подозрению в нарушении тех или иных правил.

Запомните: *не выделяйтесь!* Если вы будете неосторожны и привлечете к себе внимание персонала сети,
то вас раскроют. Пути назад уже не будет. Приведем список рекомендаций, чтобы этого не произошло:

* Не лейте слишком много трафика с одного аккаунта. Большие объемы обычно подразумевают стабильную
  прибыль и таким образом вызывают интерес к природе ваших кампаний.
* Не создавайте слишком много кампаний в одном аккаунте. Чем их больше, тем больше материала для
  проверок, тем пропорционально чаще они происходят и тем выше шанс нарваться на неприятности.
* Всегда используйте трекер. Долго работающие без трекера affiliate-кампании заставляют наблюдателя
  задуматься, как рекламодателю удается поддерживать их прибыльность.
* Всегда используйте трекинговые параметры и макросы в ссылках. Эта рекомендация по смыслу схожа с
  предыдущей и особенно актуальна для кампаний с широкими настройками таргетинга.
* Используйте функцию постбэка, если она поддерживается рекламной сетью.

Из изложенных выше соображений вытекает принцип разделения ответственности: Adspect отвечает за
защиту ваших кампаний от рутинной (пере)модерации, но ответственность за непривлечение к себе внимания
лежит на вас.

## Избегайте перенаправлений

Один из главных недостатков облачных сервисов, таких как Adspect, в том, что они увеличивают задержки
при обработке каждого клика из-за сетевого лага между вашим трекером и бэкенд-серверами сервиса.
Если вы наблюдаете большие технические потери в разделе "Статистика", то это может быть признаком
слишком высоких сетевых задержек.

Мы настоятельно рекомендуем делать цепочки редиректов как можно короче. Размещайте лендинги на своем
сервере и используйте файловый механизм их показа вместо перенаправлений на внешние ссылки.
Размещайте трекер либо до, либо после файла `index.php` в цепочке прохождения трафика, но не с обеих сторон.
Выбирайте хостинг для трекера, наиболее географически приближенный к целевой стране или региону вашего
трафика, если это возможно.

## Пиксель Facebook

Если вам необходимо использовать пиксель Facebook для "отстука" событий конверсии с вашей контент-страницы, то
**не используйте** их стандартный скрипт, т.к. он раскроет вашу контент-страницу в
[заголовке Referer](https://developer.mozilla.org/ru/docs/Web/HTTP/%D0%97%D0%B0%D0%B3%D0%BE%D0%BB%D0%BE%D0%B2%D0%BA%D0%B8/Referer).
Для этого есть сравнительно безопасные альтернативы.

:::{note}
Все перечисленные способы также подходят для защиты пикселей других рекламных сетей.
:::

### Глобальное отключение referrer

Один из способов избежать утечки referrer-а --- отключить его глобально для страницы целиком. Для этого добавьте
следующий код в тег `<head>` страницы с вашим пикселем:

```html
<meta name="referrer" content="no-referrer">
```

### Альтернативный пиксель

Другой способ обезопасить пиксель Facebook — использовать собственную версию пикселя с отключенной передачей referrer.
Facebook предоставляет "короткую" версию пикселя для посетителей без JavaScript:

```html
<img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=111111111111111&ev=Lead&noscript=1">
```

Скопируйте URL пикселя из атрибута `src` и используйте его в одном из двух безопасных вариантов ниже в зависимости
от нужного вам способа применения:

1. Статический способ с HTML iframe, подходит для вызова пикселя при загрузке страницы:

   ```html
   <iframe height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=111111111111111&ev=Lead&noscript=1" referrerpolicy="no-referrer">
   ```

2. Динамический JavaScript-способ, подходит для вызова пикселя из скрипта:

   ```html
   <script>
   fetch("https://www.facebook.com/tr?id=111111111111111&ev=Lead&noscript=1", {mode: "no-cors", referrerPolicy: "no-referrer"});
   </script>
   ```
