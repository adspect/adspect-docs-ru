# Готовые рецепты

Данная глава содержит инструкции для решения наиболее частых задач, основанные на коллективном опыте клиентов Adspect.

:::{attention}
Для клоакинга вам потребуется подписка на тариф "Клоакинг". Пожалуйста, не пытайтесь клоачить при помощи тарифа "Антифрод"!
Он не содержит необходимых для клоакинга фильтров и баз данных, так что вы лишь потеряете время, нервы и аккаунты.

Все сценарии клоакинга должны удовлетворять всем [общим рекомендациям](recommendations.md).
:::

## Клоакинг Google (поиск, GDN)

1. При создании потока выберите источник трафика "Google Ads";
2. Белую страницу **необходимо** отображать без редиректа;
3. Выполните [PHP-интеграцию](integration.md#php-integration).
   :::{important}
   Убедитесь, что в настройках фильтрации снята галочка
   ["Включить фильтрацию по JavaScript-отпечаткам и обучение модели VLA™"](streams.md#javascript-vla).
   :::

## Клоакинг Google (шаблон отслеживания)

1. При создании потока выберите источник трафика "Google Ads (шаблон отслеживания)";
2. Укажите ссылки на контент и белую страницу, выберите действие "Редирект HTTP 302" для обеих страниц;
3. Выполните [прямую PHP-интеграцию](integration.md#forward-php-integration);
   :::{important}
   Убедитесь, что в настройках фильтрации снята галочка
   ["Включить фильтрацию по JavaScript-отпечаткам и обучение модели VLA™"](streams.md#javascript-vla).
   :::
4. В шаблоне отслеживания вашей кампании добавьте к ссылке
   [ValueTrack-параметр](https://support.google.com/google-ads/answer/6305348) `url={lpurl}`, например:
   `https://tracker.link/?url={lpurl}`

## Клоакинг Facebook

1. При создании потока выберите источник трафика "Facebook";
2. Белую страницу **необходимо** отображать без редиректа;
3. Выполните [интеграцию любого типа](integration.md) в зависимости от ваших конкретных нужд.

## Клоакинг TikTok

1. При создании потока выберите источник трафика "TikTok";
2. **Рекомендуется** отображать контент и белую страницу без редиректа;
3. В ссылке рекламной кампании укажите все макросы TikTok Ads (`__CAMPAIGN_ID__`, `__PLACEMENT__` и т.п.);
4. Выполните [интеграцию любого типа](integration.md) в зависимости от ваших конкретных нужд.

## Клоакинг X (Twitter Ads)

1. При создании потока выберите источник трафика "X (Twitter Ads)";
2. Белую страницу **необходимо** отображать без редиректа;
3. Выполните [интеграцию любого типа](integration.md) в зависимости от ваших конкретных нужд.

## Клоакинг WebView

Клоакинг WebView в приложениях почти ничем не отличается от обычного клоакинга.

1. При создании потока выберите источник трафика "WebView";
2. Выполните [PHP-интеграцию](integration.md#php-integration);
3. В приложении откройте заклоаченную ссылку при помощи WebView.

## Клоакинг приложений

Adspect позволяет легко клоачить контент мобильных приложений, то есть показывать целевым пользователям и модераторам
разные элементы приложения (пэйволлы, цены, условия ребиллов, WebView и т.п.)

1. При создании потока выберите подходящий пресет для вашего источника трафика: "Google Play", "App Store" или типовой "Apps API";
2. Выполните [прямую PHP-интеграцию](integration.md#forward-php-integration) путем размещения файла `index.php` на своем домене ---
   URL этого файла будет простым HTTP API, который отвечает `200 OK` целевым пользователям и
   `403 Forbidden` всем остальным (модераторам);
3. Внутри приложения сделайте простой HTTP-запрос `GET` на URL вашего API и производите дальнейшие действия
   в зависимости от кода ответа:
   - 200 -- пользователь целевой, можно показывать чувствительный контент;
   - любой другой код или ошибка -- считайте пользователя модератором, не показывайте чувствительный контент.

Вы можете изменить формат ответов API при помощи выбора других действий для контента и белой страницы.
Например, можно возвращать JSON-данные вместо пустого ответа 200 для целевых пользователей:

- Действие: выполнить PHP-код
- Поле страницы: `echo json_encode(['user_is_legit' => true]);`

(detecting-bot-zones)=
## Фильтрация ботовых площадок

Популярные форматы рекламы, такие как баннеры, тизеры, нативная реклама и popunder, все наводнены ботами
для накрутки кликов --- [кликфродом](https://ru.wikipedia.org/wiki/%D0%9A%D0%BB%D0%B8%D0%BA%D1%84%D1%80%D0%BE%D0%B4).
Adspect с легкостью обнаруживает их всех, позволяя вам быстро составлять черные списки фродящих
паблишеров/площадок/сайтов/спотов (далее --- "площадок"):

1. В настройках потока заполните [поле Sub ID](streams.md#sub-id), указав в нем имя параметра ссылки,
   в котором рекламная сеть будет передавать идентификатор площадки, например `subid`;
3. В рекламной кампании добавьте этот параметр к рекламной ссылке, подставив в него подходящий по смыслу
   макрос, например `subid={zoneid}` или `subid=__PLACEMENT__` (обратитесь в поддержку рекламной сети,
   чтобы получить список поддерживаемых макросов);
3. В разделе ["Статистика"](reporting.md) личного кабинета выберите разбивку воронки по Sub ID;
4. Оцените качество трафика отдельных площадок по колонке "Качество" и составьте черный список площадок,
   например, с качеством 75% и ниже (т.е. тех, где как минимум ¼ всего трафика --- боты).

Сперва занесите в блеклист фродящие площадки, что сэкономит вам уйму денег на старте, а уже далее переходите
к фильтрации площадок по прибыли или ROI как обычно.

## Сокрытие источника трафика

Источник трафика обычно легко обнаружить по передаваемому в каждом клике
[HTTP-заголовку Referer](https://developer.mozilla.org/ru/docs/Web/HTTP/%D0%97%D0%B0%D0%B3%D0%BE%D0%BB%D0%BE%D0%B2%D0%BA%D0%B8/Referer).
Если вы хотите скрыть его от тех, кто получает ваш трафик, то добавьте следующий код после тега `<head>`
в PHP-файле вашего потока Adspect (`index.php` или `filter.php`):

```html
<meta name="referrer" content="no-referrer">
```

Если вы используете JavaScript-интеграцию, то добавьте этот код в вашу белую страницу.
